Title: 线性代数基础
Date: 2019-05-05
Slug: linear_algebra
Category: 机器学习
Tags: 线性代数

# 一、场景

线性代数简单来讲，是用来处理线性方程式相关的问题，从而让整个解法简单，容易理解。

例如对于下面的3个线性方程：

$$y_1 = 1 + 2 * x_1 + 3 * x_2\\
y_2 = 4 + 5 * x_1 + 6 * x_2\\
y_3 = 7+ 8 * x_1 + 9 * x_2$$

有如下样本数据：

$$
x_1, x_2\\
11,22\\
33,44\\
55,66\\
77,88
$$

需要计算出各自的$y_1, y_2, y_3$

如果按照常规的写法，可能类似于(python)：
```python
def f1(x1, x2):
    return 1 + 2 * x1 + 3 * x2
def f2(x1, x2):
    return 4 + 5 * x1 + 6 * x2
def f3(x1, x2):
    return 7 + 8 * x1 + 9 * x2

x = [
    (11,22),
    (33,44),
    (55,66),
    (77,88)
]
result = []
for x1, x2 in x:
    x_reslut = []
    for f in [f1, f2, f3]:
        x_reslut.append(f(x1, x2))
    result.append(x_reslut)

result
```
结果是：

```python
[[89, 191, 293], [199, 433, 667], [309, 675, 1041], [419, 917, 1415]]
```

写法较为复杂，用线性代数方式，可以通过构造两个矩阵
$$
X=
\begin{bmatrix}
1&11&22\\
1&33&44\\
1&55&66\\
1&77&88
\end{bmatrix}
$$

$$
Y=
\begin{bmatrix}
1&4&7\\
2&5&8\\
3&6&9
\end{bmatrix}
$$

然后通过 $X*Y$ 就可以计算出所有的结果(python+numpy)

```python
import numpy as np

X = np.array([
    [1,11,22],
    [1,33,44],
    [1,55,66],
    [1,77,88],
])
Y = np.array([
    [1,4,7],
    [2,5,8],
    [3,6,9],
])
np.dot(X, Y)
```
结果是：
```python
array([[  89,  191,  293],
       [ 199,  433,  667],
       [ 309,  675, 1041],
       [ 419,  917, 1415]])
```

这种方式不仅写法较为简单，而且都是矩阵操作，执行性能也非常高（具体乘法是如何算的下面会讲）。

# 二、矩阵

一个$m*n$的矩阵是一个由$m$行（row）$n$列（column）元素排列成的矩形阵列。矩阵里的元素可以是数字、符号或数学式。以下矩阵$A$是一个由6个数字元素构成的2行3列的矩阵：

$$
A=
\begin{bmatrix}
1&2&3\\
4&5&6\\
\end{bmatrix}
$$

矩阵的概念比较简单，就是以指定的形式排列数据。

下面介绍几个特殊的矩阵：

1. 单位矩阵

一个$n$阶单位矩阵，是一个$n*n$的方形矩阵，其主对角线元素为1，其余元素为0，单位矩阵以$I_n$表示。例如：
$$
I_1 = 
\begin{bmatrix}
1
\end{bmatrix}
$$


$$
I_2 = 
\begin{bmatrix}
1&0\\
0&1
\end{bmatrix}
$$

$$
I_3 = 
\begin{bmatrix}
1&0&0\\
0&1&0\\
0&0&1
\end{bmatrix}
$$

# 三、矩阵操作

## 3.1 矩阵加法

只有维度相同的矩阵才能计算加法，将对应位置的元素相加即可，例如

$$
A=
\begin{bmatrix}
1&2&3\\
4&5&6\\
\end{bmatrix}
$$

$$
B=
\begin{bmatrix}
7&8&9\\
0&1&2\\
\end{bmatrix}
$$

$$
A+B=
\begin{bmatrix}
1+7&2+8&3+9\\
4+0&5+1&6+2\\
\end{bmatrix}
=
\begin{bmatrix}
8&10&12\\
4&6&8\\
\end{bmatrix}
$$

## 3.2 矩阵减法

矩阵减法与加法类似，对应位置元素相减即可，例如：

$$
A=
\begin{bmatrix}
1&2&3\\
4&5&6\\
\end{bmatrix}
$$

$$
B=
\begin{bmatrix}
7&8&9\\
0&1&2\\
\end{bmatrix}
$$

$$
A-B=
\begin{bmatrix}
1-7&2-8&3-9\\
4-0&5-1&6-2\\
\end{bmatrix}
=
\begin{bmatrix}
-6&-6&-6\\
4&4&4\\
\end{bmatrix}
$$

## 3.3 矩阵乘法

矩阵乘法比较特殊，两个矩阵相乘$A*B$，需要矩阵$A$的列数与矩阵$B$和行数相同，即$m*n$的矩阵只能和$n*o$的矩阵相乘。

相乘得到的矩阵$C$，为矩阵$A$的行数$m$和矩阵$B$的列数$o$，即$m*o$。

矩阵$C$的第$i$行第$j$列的元素等于矩阵$A$的第$i$行的元素与矩阵$B$的第$j$列对应元素乘积之和。

例如：

$$
A=
\begin{bmatrix}
1&2&3\\
4&5&6
\end{bmatrix}
$$

$$
B=
\begin{bmatrix}
11&44\\
22&55\\
33&66
\end{bmatrix}
$$

$$
A*B=
\begin{bmatrix}
1*11+2*22+3*33&1*44+2*55+3*66\\
4*11+5*22+6*33&4*44+5*55+6*66
\end{bmatrix}
=
\begin{bmatrix}
154&352\\
352&847
\end{bmatrix}
$$

```python
import numpy as np

A = np.array([
    [1,2,3],
    [4,5,6],
])
B = np.array([
    [11,44],
    [22,55],
    [33,66],
])
np.dot(A, B)
```
```python
array([[154, 352],
       [352, 847]])
```

## 3.4 矩阵除法

矩阵除法一般叫为求逆矩阵，即对于方阵$A$($n*n$)，求另一个矩阵$B$($n*n$)，满足$A*B=I_n$。

这里简单介绍一下用初等行变换求矩阵的逆，初等行变换有三种操作：

1. 两行（列）互换
2. 把某行（列）乘以一非零常数
3. 把第i行（列）加上第j行（列）的k倍

其计算过程如下：

1. 作一个$n*2n$的矩阵$[A，I_n]$
2. 通过初等行变化，将该矩阵变换为$[I_n, B]$
3. 此时矩阵$B$就是$A$的逆矩阵

例如对于矩阵
$$
A=
\begin{bmatrix}
2&3&1\\
0&1&3\\
1&2&5
\end{bmatrix}
$$

通过如下变化

```python
import numpy as np

A = np.mat([
    [2,3,1],
    [0,1,3],
    [1,2,5],
])
print 'A: '
print A

print 'target: '
print np.linalg.inv(A)

print 'solve: '
print A
A = np.concatenate([A,  np.eye(3)], 1)
print A
A[0,:] = A[0,:] / 2.0 
print A

A[2,:] = A[2,:] - A[0,:]
print A

A[2,:] = A[2,:] - 0.5*A[1,:]
print A

A[2,:] = A[2,:] / 3.0
print A

A[1,:] = A[1,:] - 3.0*A[2,:]
print A

A[0,:] = A[0,:] - 0.5*A[2,:]
print A

A[0,:] = A[0,:] - 1.5*A[1,:]
print A
```

```python
A: 
[[2 3 1]
 [0 1 3]
 [1 2 5]]
target: 
[[-0.16666667 -2.16666667  1.33333333]
 [ 0.5         1.5        -1.        ]
 [-0.16666667 -0.16666667  0.33333333]]
solve: 
[[2 3 1]
 [0 1 3]
 [1 2 5]]
[[2. 3. 1. 1. 0. 0.]
 [0. 1. 3. 0. 1. 0.]
 [1. 2. 5. 0. 0. 1.]]
[[1.  1.5 0.5 0.5 0.  0. ]
 [0.  1.  3.  0.  1.  0. ]
 [1.  2.  5.  0.  0.  1. ]]
[[ 1.   1.5  0.5  0.5  0.   0. ]
 [ 0.   1.   3.   0.   1.   0. ]
 [ 0.   0.5  4.5 -0.5  0.   1. ]]
[[ 1.   1.5  0.5  0.5  0.   0. ]
 [ 0.   1.   3.   0.   1.   0. ]
 [ 0.   0.   3.  -0.5 -0.5  1. ]]
[[ 1.          1.5         0.5         0.5         0.          0.        ]
 [ 0.          1.          3.          0.          1.          0.        ]
 [ 0.          0.          1.         -0.16666667 -0.16666667  0.33333333]]
[[ 1.          1.5         0.5         0.5         0.          0.        ]
 [ 0.          1.          0.          0.5         1.5        -1.        ]
 [ 0.          0.          1.         -0.16666667 -0.16666667  0.33333333]]
[[ 1.          1.5         0.          0.58333333  0.08333333 -0.16666667]
 [ 0.          1.          0.          0.5         1.5        -1.        ]
 [ 0.          0.          1.         -0.16666667 -0.16666667  0.33333333]]
[[ 1.          0.          0.         -0.16666667 -2.16666667  1.33333333]
 [ 0.          1.          0.          0.5         1.5        -1.        ]
 [ 0.          0.          1.         -0.16666667 -0.16666667  0.33333333]]
```
可以得到其逆矩阵
$$
B=
\begin{bmatrix}
-0.16666667&-2.16666667&1.33333333\\
0.5&1.5&-1.\\
-0.16666667&-0.16666667&0.33333333
\end{bmatrix}
$$

## 3.5 矩阵转置

矩阵转置是指将矩阵按照对角线交换位置，简单来讲，就是将原矩阵$A$逐行变成逐列，记做$A^T$，例如：

$$
A=
\begin{bmatrix}
1&2&3\\
4&5&6
\end{bmatrix}
$$

$$
A^T=
\begin{bmatrix}
1&4\\
2&5\\
3&6
\end{bmatrix}
$$

参考：

1. https://zh.wikipedia.org/wiki/%E5%88%9D%E7%AD%89%E7%9F%A9%E9%98%B5

